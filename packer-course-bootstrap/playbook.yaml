---
- hosts: all
  become: yes
  tasks:
    - name: Install package GIT
      package:
        name: git
        state: latest
    - name: pull from git
      git:
        repo: https://github.com/BastienBalaud/golang-myip
        dest: /root/golang
        update: yes
        version: master
    - name : install make
      command : dnf install make.x86_64 -y

    - name : install go
      command : dnf install golang.x86_64 -y

    - name: make golang
      ansible.builtin.shell:
       cmd: make
       chdir: /root/golang/golang-myip

    - name: run server
      command: cd /root/golang/golang-myip/build
      ansible.builtin.shell:
       cmd: server.x86_64

    - name: Add ssh key
      authorized_key:
       user: root
       state: present
       key: https://github.com/BastienBalaud.keys 
